执行已发布的工作流，响应方式为流式响应。
接口说明
调用 API 执行工作流时，对于支持流式输出的工作流，往往需要使用流式响应方式接收响应数据，例如实时展示工作流的输出信息、呈现打字机效果等。
在流式响应中，服务端不会一次性发送所有数据，而是以数据流的形式逐条发送数据给客户端，数据流中包含工作流执行过程中触发的各种事件（event），直至处理完毕或处理中断。处理结束后，服务端会通过 event: Done 事件提示工作流执行完毕。各个事件的说明可参考返回结果。
目前支持流式响应的工作流节点包括输出节点、问答节点和开启了流式输出的结束节点。对于不包含这些节点的工作流，可以使用执行工作流接口一次性接收响应数据。

限制说明
通过 API 方式执行工作流前，应确认此工作流已发布，执行从未发布过的工作流时会返回错误码 4200。创建并发布工作流的操作可参考使用工作流。
调用此 API 之前，应先在扣子平台中试运行此工作流。
如果试运行时需要关联智能体，则调用此 API 执行工作流时，也需要指定 bot_id。通常情况下，执行存在数据库节点、变量节点等节点的工作流需要关联智能体。
执行应用中的工作流时，需要指定 app_id。
请勿同时指定 bot_id 和 app_id，否则 API 会报错 4000，表示请求参数错误。
此接口为同步接口，如果工作流整体或某些节点运行超时，智能体可能无法提供符合预期的回复，建议将工作流的执行时间控制在 5 分钟以内。同步执行时，工作流整体超时时间限制可参考工作流使用限制。
工作流支持的请求大小上限为 20MB，包括输入参数以及运行期间产生的消息历史等所有相关数据。
基础信息
请求方式
POST
请求地址
https://api.coze.cn/v1/workflow/stream_run

权限
run
确保调用该接口使用的访问令牌开通了 run 权限，详细信息参考鉴权方式概述。
接口说明
执行已发布的工作流，响应方式为流式响应。

Header
 
Body
参数
类型
是否必选
说明
workflow_id
String 
必选
待执行的 Workflow ID，此工作流应已发布。
进入 Workflow 编排页面，在页面 URL 中，workflow 参数后的数字就是 Workflow ID。例如 https://www.coze.com/work_flow?space_id=42463***&workflow_id=73505836754923***，Workflow ID 为 73505836754923***。
parameters
map[String]Any
可选
工作流开始节点的输入参数及取值，你可以在指定工作流的编排页面查看参数列表。
如果工作流输入参数为 Image 等类型的文件，你可以传入文件 URL 或调用上传文件 API 获取 file_id 后传入 file_id。示例：
上传文件并传入 file_id：
单个文件示例："parameters": { "image": "{\"file_id\":\"1122334455\"}" }
文件数组示例："parameters": { "image": [ "{\"file_id\":\"1122334455\"}" ] }。
传入文件 URL：
“parameters” :{"input":"请总结图片内容", "image": "https://example.com/tos-cn-i-mdko3gqilj/example.png" } 
bot_id

String 

可选

需要关联的智能体ID。 部分工作流执行时需要指定关联的智能体，例如存在数据库节点、变量节点等节点的工作流。
 
进入智能体的开发页面，开发页面 URL 中 bot 参数后的数字就是智能体ID。例如 https://www.coze.com/space/341****/bot/73428668*****，Bot ID 为 73428668*****。 
确保调用该接口使用的令牌开通了此智能体所在空间的权限。
确保该智能体已发布为 API 服务。

ext
Map[String][String]

可选
用于指定一些额外的字段，以 Map[String][String] 格式传入。例如某些插件会隐式用到的经纬度等字段。
目前仅支持以下字段：
latitude：String 类型，表示纬度。
longitude：String 类型，表示经度。
user_id：String 类型，表示用户 ID。
app_id
String
可选
工作流所在的应用 ID。
你可以通过应用的业务编排页面 URL 中获取应用 ID，也就是 URL 中 project-ide 参数后的一串字符，例如 https://www.coze.cn/space/739174157340921****/project-ide/743996105122521****/workflow/744102227704147**** 中，应用的 ID 为 743996105122521****。
仅运行扣子应用中的工作流时，才需要设置 app_id。智能体绑定的工作流、空间资源库中的工作流无需设置 app_id。

workflow_version


String

可选

工作流的版本号，仅当运行的工作流属于资源库工作流时有效。未指定版本号时默认执行最新版本的工作流。

connector_id
String

可选

渠道 ID，用于配置该工作流在什么渠道执行。
当智能体或扣子应用发布到某个渠道后，可以通过该参数指定工作流在对应的渠道执行。
扣子的渠道 ID 包括：
1024（默认值）：API 渠道。
999：Chat SDK。
998：WebSDK。
10000122：扣子商店。
10000113：微信客服。
10000120：微信服务号。
10000121：微信订阅号。
10000126：抖音小程序。
10000127：微信小程序。
10000011：飞书。
10000128：飞书多维表格。
10000117：掘金。
自定义渠道 ID。自定义渠道 ID 的获取方式如下：在扣子左下角单击头像，在账号设置 > 发布渠道 > 企业自定义渠道管理页面查看渠道 ID。
不同渠道的用户数据、会话记录等相互隔离，进行数据分析统计时，不支持跨渠道数据调用。


返回结果
 
示例
请求示例
curl --location --request POST 'https://api.coze.cn/v1/workflow/stream_run' \
--header 'Authorization: Bearer pat_fhwefweuk****' \
--header 'Content-Type: application/json' \
--data-raw '{
    "workflow_id": "73664689170551*****",
    "parameters": {
        "user_name":"George"
    }
}'

响应示例